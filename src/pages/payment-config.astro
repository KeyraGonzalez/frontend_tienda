---
import Layout from '../layouts/Layout.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
---

<Layout title="Configuración de Pagos">
  <Header />
  <main class="min-h-screen bg-gray-50 pt-24 pb-12">
    <div class="max-w-2xl mx-auto px-4">
      <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
        <h1 class="text-2xl font-bold text-black mb-6 tracking-wide uppercase">Configuración de Métodos de Pago</h1>
        
        <!-- Important Notice -->
        <div class="bg-gray-50 border-l-4 border-black p-4 mb-6">
          <div class="flex">
            <div class="flex-shrink-0">
              <svg class="h-5 w-5 text-black" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path>
              </svg>
            </div>
            <div class="ml-3">
              <p class="text-sm text-gray-700 font-medium">
                <strong class="tracking-wide uppercase">Nota Importante:</strong> Las siguientes claves son solo para propósitos de demostración. 
                En un entorno de producción, estas claves deben configurarse en variables de entorno del servidor.
              </p>
            </div>
          </div>
        </div>

        <!-- Stripe Configuration -->
        <section class="mb-8">
          <h2 class="text-lg font-bold text-black mb-4 flex items-center tracking-wide uppercase">
            <svg class="w-6 h-6 mr-2 text-black" viewBox="0 0 24 24" fill="currentColor">
              <path d="M13.976 9.15c-2.172-.806-3.356-1.426-3.356-2.409 0-.831.683-1.305 1.901-1.305 2.227 0 4.515.858 6.09 1.631l.89-5.494C18.252.975 15.697 0 12.165 0 9.667 0 7.589.654 6.104 1.872 4.56 3.147 3.757 4.992 3.757 7.218c0 4.039 2.467 5.76 6.476 7.219 2.585.92 3.445 1.574 3.445 2.583 0 .98-.84 1.545-2.354 1.545-1.875 0-4.965-.921-6.99-2.109l-.9 5.555C5.175 22.99 8.385 24 11.714 24c2.641 0 4.843-.624 6.328-1.813 1.664-1.305 2.525-3.236 2.525-5.732 0-4.128-2.524-5.851-6.591-7.305z"/>
            </svg>
            Configuración de Stripe
          </h2>
          
          <div class="space-y-4">
            <div>
              <label class="block text-sm font-bold text-black mb-1 tracking-wide uppercase">
                Clave Pública (Publishable Key)
              </label>
              <input 
                type="text" 
                id="stripe-publishable-key"
                placeholder="pk_test_..."
                class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-black"
              >
              <p class="text-xs text-gray-500 mt-1">
                Esta clave se usa en el frontend para inicializar Stripe
              </p>
            </div>
            
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">
                Webhook Secret (Opcional)
              </label>
              <input 
                type="text" 
                id="stripe-webhook-secret"
                placeholder="whsec_..."
                class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-purple-500"
              >
              <p class="text-xs text-gray-500 mt-1">
                Secreto para verificar webhooks de Stripe
              </p>
            </div>
          </div>
        </section>

        <!-- PayPal Configuration -->
        <section class="mb-8">
          <h2 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
            <svg class="w-6 h-6 mr-2 text-blue-600" viewBox="0 0 24 24" fill="currentColor">
              <path d="M7.076 21.337H2.47a.641.641 0 0 1-.633-.74L4.944.901C5.026.382 5.474 0 5.998 0h7.46c2.57 0 4.578.543 5.69 1.81 1.01 1.15 1.304 2.42 1.012 4.287-.023.143-.047.288-.077.437-.983 5.05-4.349 6.797-8.647 6.797h-2.19c-.524 0-.968.382-1.05.9l-1.12 7.106zm14.146-14.42a3.35 3.35 0 0 0-.988-.3c-.45-.05-.99-.075-1.6-.075h-4.194c-.524 0-.968.382-1.05.9L12.277 12.5c-.082.518.25.937.774.937h1.859c3.185 0 5.688-1.29 6.417-5.02.298-1.52.138-2.795-.605-3.5z"/>
            </svg>
            Configuración de PayPal
          </h2>
          
          <div class="space-y-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">
                Client ID
              </label>
              <input 
                type="text" 
                id="paypal-client-id"
                placeholder="AYsyYdKmn..."
                class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
              >
              <p class="text-xs text-gray-500 mt-1">
                Client ID de tu aplicación de PayPal
              </p>
            </div>
            
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">
                Entorno
              </label>
              <select 
                id="paypal-environment"
                class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
              >
                <option value="sandbox">Sandbox (Pruebas)</option>
                <option value="production">Producción</option>
              </select>
              <p class="text-xs text-gray-500 mt-1">
                Usa Sandbox para pruebas y Producción para pagos reales
              </p>
            </div>
          </div>
        </section>

        <!-- Test Instructions -->
        <section class="mb-8">
          <h2 class="text-lg font-semibold text-gray-900 mb-4">Instrucciones de Prueba</h2>
          
          <div class="bg-gray-50 rounded-lg p-4 space-y-4">
            <div>
              <h3 class="font-medium text-gray-900 mb-2">Stripe - Tarjetas de Prueba</h3>
              <div class="text-sm text-gray-600 space-y-1">
                <p><strong>Éxito:</strong> 4242424242424242</p>
                <p><strong>Fallo:</strong> 4000000000000002</p>
                <p><strong>Requiere 3D Secure:</strong> 4000002500003155</p>
                <p>Usa cualquier fecha futura para MM/AA y cualquier CVC de 3 dígitos</p>
              </div>
            </div>
            
            <div>
              <h3 class="font-medium text-gray-900 mb-2">PayPal - Cuentas de Prueba</h3>
              <div class="text-sm text-gray-600">
                <p>Crea cuentas de prueba en el Developer Dashboard de PayPal</p>
                <p>o usa las credenciales facilitadas por PayPal para sandbox</p>
              </div>
            </div>
          </div>
        </section>

        <!-- Action Buttons -->
        <div class="flex space-x-4">
          <button 
            id="save-config-btn"
            class="flex-1 bg-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-blue-700 transition-colors"
          >
            Guardar Configuración
          </button>
          
          <button 
            id="test-config-btn"
            class="flex-1 bg-green-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-green-700 transition-colors"
          >
            Probar Configuración
          </button>
        </div>

        <!-- Status Message -->
        <div id="status-message" class="mt-4 p-3 rounded-lg hidden">
          <!-- Status messages will appear here -->
        </div>
      </div>
    </div>
  </main>

  <Footer />
</Layout>

<script>
  import { initializePaymentConfigPage } from '../scripts/payment-config.ts';

  document.addEventListener('DOMContentLoaded', async function() {
    await initializePaymentConfigPage();
  });
</script>
